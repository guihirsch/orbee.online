<!doctype html>
<html>
   <head>
      <title>Visualiza√ß√£o de Pontos Cr√≠ticos NDVI</title>
      <meta charset="utf-8" />
      <style>
         body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
         }
         .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
         }
         h1 {
            color: #333;
            text-align: center;
         }
         .info-box {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
         }
         .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
         }
         .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
         }
         .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #333;
         }
         .coordinates {
            font-family: monospace;
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
         }
         .point-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
         }
         .point-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
         }
         .point-item:last-child {
            border-bottom: none;
         }
         .ndvi-value {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 15px;
            color: white;
         }
         .ndvi-very-low {
            background-color: #dc3545;
         }
         .ndvi-low {
            background-color: #fd7e14;
         }
         .ndvi-medium {
            background-color: #ffc107;
            color: #333;
         }
         .ndvi-na {
            background-color: #6c757d;
         }
      </style>
   </head>
   <body>
      <div class="container">
         <h1>üó∫Ô∏è An√°lise de Pontos Cr√≠ticos NDVI</h1>

         <div class="info-box">
            <h3>üìä Resumo dos Dados</h3>
            <p>
               <strong>Total de pontos:</strong>
               <span id="total-points">-</span>
            </p>
            <p><strong>NDVI m√≠nimo:</strong> <span id="min-ndvi">-</span></p>
            <p><strong>NDVI m√°ximo:</strong> <span id="max-ndvi">-</span></p>
            <p><strong>NDVI m√©dio:</strong> <span id="avg-ndvi">-</span></p>
         </div>

         <div class="legend">
            <div class="legend-item">
               <div
                  class="legend-color"
                  style="background-color: #dc3545"
               ></div>
               <span>NDVI < 0.1 (Muito Baixo)</span>
            </div>
            <div class="legend-item">
               <div
                  class="legend-color"
                  style="background-color: #fd7e14"
               ></div>
               <span>NDVI 0.1-0.2 (Baixo)</span>
            </div>
            <div class="legend-item">
               <div
                  class="legend-color"
                  style="background-color: #ffc107"
               ></div>
               <span>NDVI 0.2-0.3 (M√©dio)</span>
            </div>
            <div class="legend-item">
               <div
                  class="legend-color"
                  style="background-color: #6c757d"
               ></div>
               <span>NDVI N/A</span>
            </div>
         </div>

         <div class="coordinates">
            <h3>üìç Coordenadas dos Pontos</h3>
            <p>
               <strong>Centro da √°rea:</strong>
               <span id="center-coords">-</span>
            </p>
            <p><strong>Range de coordenadas:</strong></p>
            <p>Latitude: <span id="lat-range">-</span></p>
            <p>Longitude: <span id="lon-range">-</span></p>
         </div>

         <h3>üîç Lista de Pontos Cr√≠ticos</h3>
         <div class="point-list" id="point-list">
            <p>Carregando dados...</p>
         </div>
      </div>

      <script>
         // Dados dos pontos cr√≠ticos (ser√£o carregados do JSON)
         let criticalPoints = [];

         // Fun√ß√£o para carregar dados do JSON
         async function loadData() {
            try {
               const response = await fetch("critical_points_sr (1).json");
               const data = await response.json();
               criticalPoints = data.features;
               processData();
            } catch (error) {
               console.error("Erro ao carregar dados:", error);
               document.getElementById("point-list").innerHTML =
                  "<p>Erro ao carregar dados. Verifique se o arquivo JSON est√° no mesmo diret√≥rio.</p>";
            }
         }

         // Fun√ß√£o para processar e exibir os dados
         function processData() {
            if (criticalPoints.length === 0) return;

            // Calcular estat√≠sticas
            const ndviValues = criticalPoints
               .map((p) => p.properties.ndvi)
               .filter((v) => v !== null && v !== undefined);

            const minNdvi = Math.min(...ndviValues);
            const maxNdvi = Math.max(...ndviValues);
            const avgNdvi =
               ndviValues.reduce((a, b) => a + b, 0) / ndviValues.length;

            // Calcular coordenadas
            const lats = criticalPoints.map((p) => p.geometry.coordinates[1]);
            const lons = criticalPoints.map((p) => p.geometry.coordinates[0]);
            const centerLat = lats.reduce((a, b) => a + b, 0) / lats.length;
            const centerLon = lons.reduce((a, b) => a + b, 0) / lons.length;

            // Atualizar informa√ß√µes
            document.getElementById("total-points").textContent =
               criticalPoints.length;
            document.getElementById("min-ndvi").textContent =
               minNdvi.toFixed(4);
            document.getElementById("max-ndvi").textContent =
               maxNdvi.toFixed(4);
            document.getElementById("avg-ndvi").textContent =
               avgNdvi.toFixed(4);
            document.getElementById("center-coords").textContent =
               `${centerLat.toFixed(6)}, ${centerLon.toFixed(6)}`;
            document.getElementById("lat-range").textContent =
               `${Math.min(...lats).toFixed(6)} a ${Math.max(...lats).toFixed(6)}`;
            document.getElementById("lon-range").textContent =
               `${Math.min(...lons).toFixed(6)} a ${Math.max(...lons).toFixed(6)}`;

            // Criar lista de pontos
            const pointList = document.getElementById("point-list");
            pointList.innerHTML = "";

            criticalPoints.forEach((point, index) => {
               const coords = point.geometry.coordinates;
               const ndvi = point.properties.ndvi;

               const pointDiv = document.createElement("div");
               pointDiv.className = "point-item";

               let ndviClass = "ndvi-na";
               let ndviText = "N/A";

               if (ndvi !== null && ndvi !== undefined) {
                  if (ndvi < 0.1) {
                     ndviClass = "ndvi-very-low";
                  } else if (ndvi < 0.2) {
                     ndviClass = "ndvi-low";
                  } else {
                     ndviClass = "ndvi-medium";
                  }
                  ndviText = ndvi.toFixed(4);
               }

               pointDiv.innerHTML = `
                    <div>
                        <strong>Ponto ${index + 1}</strong><br>
                        <small>Lat: ${coords[1].toFixed(6)}, Lon: ${coords[0].toFixed(6)}</small>
                    </div>
                    <div class="ndvi-value ${ndviClass}">
                        ${ndviText}
                    </div>
                `;

               pointList.appendChild(pointDiv);
            });
         }

         // Carregar dados quando a p√°gina carregar
         window.addEventListener("load", loadData);
      </script>
   </body>
</html>
